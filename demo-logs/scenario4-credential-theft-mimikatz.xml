<!--
SCENARIO 4: Credential Theft using Mimikatz
Timeline: Attacker runs Mimikatz to dump credentials from LSASS process memory
Threat Level: CRITICAL - Credential Access, Privilege Escalation
OCSF Mapping: Process Activity, Security Finding
Attribution: Common post-exploitation technique used by multiple threat actors
-->

<!-- EVENT 1: Sysmon Event ID 1 - Mimikatz Process Execution -->
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Sysmon" Guid="{5770385F-C22A-43E0-BF4C-06F5698FFBD9}" />
    <EventID>1</EventID>
    <Version>5</Version>
    <Level>4</Level>
    <Task>1</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8000000000000000</Keywords>
    <TimeCreated SystemTime="2025-12-01T11:30:15.678Z" />
    <EventRecordID>645123</EventRecordID>
    <Correlation />
    <Execution ProcessID="2856" ThreadID="3912" />
    <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
    <Computer>FBI-FIELD-OFFICE-23.fbi.gov</Computer>
    <Security UserID="S-1-5-18" />
  </System>
  <EventData>
    <Data Name="RuleName">technique_id=T1003.001,technique_name=OS Credential Dumping LSASS Memory</Data>
    <Data Name="UtcTime">2025-12-01 11:30:15.678</Data>
    <Data Name="ProcessGuid">{F6A7B8C9-0123-4DEF-5678-901234567890}</Data>
    <Data Name="ProcessId">8756</Data>
    <Data Name="Image">C:\Users\Public\Downloads\mim.exe</Data>
    <Data Name="FileVersion">2.2.0.20220919</Data>
    <Data Name="Description">mimikatz for Windows</Data>
    <Data Name="Product">mimikatz</Data>
    <Data Name="Company">Benjamin Delpy (gentilkiwi)</Data>
    <Data Name="OriginalFileName">mimikatz.exe</Data>
    <Data Name="CommandLine">"C:\Users\Public\Downloads\mim.exe" privilege::debug sekurlsa::logonpasswords exit</Data>
    <Data Name="CurrentDirectory">C:\Users\Public\Downloads\</Data>
    <Data Name="User">FBI\admin.local</Data>
    <Data Name="LogonGuid">{F6A7B8C9-0123-4DEF-1111-AABBCCDDEE00}</Data>
    <Data Name="LogonId">0x4A3B2C</Data>
    <Data Name="TerminalSessionId">2</Data>
    <Data Name="IntegrityLevel">High</Data>
    <Data Name="Hashes">SHA256=B4C5D6E7F8A9B0C1D2E3F4A5B6C7D8E9F0A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5,MD5=A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6,IMPHASH=F1E2D3C4B5A6978809F0E1D2C3B4A596</Data>
    <Data Name="ParentProcessGuid">{F6A7B8C9-0123-4DEF-5678-ABCDEFABCDEF}</Data>
    <Data Name="ParentProcessId">5624</Data>
    <Data Name="ParentImage">C:\Windows\System32\cmd.exe</Data>
    <Data Name="ParentCommandLine">cmd.exe /c mim.exe privilege::debug sekurlsa::logonpasswords exit</Data>
    <Data Name="ParentUser">FBI\admin.local</Data>
  </EventData>
</Event>

<!-- EVENT 2: Sysmon Event ID 10 - Process Access (LSASS Memory Read) -->
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Sysmon" Guid="{5770385F-C22A-43E0-BF4C-06F5698FFBD9}" />
    <EventID>10</EventID>
    <Version>3</Version>
    <Level>4</Level>
    <Task>10</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8000000000000000</Keywords>
    <TimeCreated SystemTime="2025-12-01T11:30:16.234Z" />
    <EventRecordID>645124</EventRecordID>
    <Correlation />
    <Execution ProcessID="2856" ThreadID="3912" />
    <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
    <Computer>FBI-FIELD-OFFICE-23.fbi.gov</Computer>
    <Security UserID="S-1-5-18" />
  </System>
  <EventData>
    <Data Name="RuleName">technique_id=T1003.001,technique_name=LSASS Memory Access</Data>
    <Data Name="UtcTime">2025-12-01 11:30:16.234</Data>
    <Data Name="SourceProcessGUID">{F6A7B8C9-0123-4DEF-5678-901234567890}</Data>
    <Data Name="SourceProcessId">8756</Data>
    <Data Name="SourceThreadId">9124</Data>
    <Data Name="SourceImage">C:\Users\Public\Downloads\mim.exe</Data>
    <Data Name="TargetProcessGUID">{F6A7B8C9-0123-4DEF-5678-LSASSLSASSLSA}</Data>
    <Data Name="TargetProcessId">676</Data>
    <Data Name="TargetImage">C:\Windows\System32\lsass.exe</Data>
    <Data Name="GrantedAccess">0x1FFFFF</Data>
    <Data Name="CallTrace">C:\Windows\SYSTEM32\ntdll.dll+9d4c4|C:\Windows\System32\KERNELBASE.dll+2c13e|C:\Users\Public\Downloads\mim.exe+1c2f8|C:\Users\Public\Downloads\mim.exe+1beef|C:\Users\Public\Downloads\mim.exe+dc34|C:\Users\Public\Downloads\mim.exe+d218|C:\Windows\System32\KERNEL32.DLL+17034|C:\Windows\SYSTEM32\ntdll.dll+526a1</Data>
    <Data Name="SourceUser">FBI\admin.local</Data>
    <Data Name="TargetUser">NT AUTHORITY\SYSTEM</Data>
  </EventData>
</Event>

<!-- EVENT 3: Sysmon Event ID 8 - CreateRemoteThread (Credential Dumping Technique) -->
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Sysmon" Guid="{5770385F-C22A-43E0-BF4C-06F5698FFBD9}" />
    <EventID>8</EventID>
    <Version>2</Version>
    <Level>4</Level>
    <Task>8</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8000000000000000</Keywords>
    <TimeCreated SystemTime="2025-12-01T11:30:16.456Z" />
    <EventRecordID>645125</EventRecordID>
    <Correlation />
    <Execution ProcessID="2856" ThreadID="3912" />
    <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
    <Computer>FBI-FIELD-OFFICE-23.fbi.gov</Computer>
    <Security UserID="S-1-5-18" />
  </System>
  <EventData>
    <Data Name="RuleName">technique_id=T1055,technique_name=Process Injection</Data>
    <Data Name="UtcTime">2025-12-01 11:30:16.456</Data>
    <Data Name="SourceProcessGuid">{F6A7B8C9-0123-4DEF-5678-901234567890}</Data>
    <Data Name="SourceProcessId">8756</Data>
    <Data Name="SourceImage">C:\Users\Public\Downloads\mim.exe</Data>
    <Data Name="TargetProcessGuid">{F6A7B8C9-0123-4DEF-5678-LSASSLSASSLSA}</Data>
    <Data Name="TargetProcessId">676</Data>
    <Data Name="TargetImage">C:\Windows\System32\lsass.exe</Data>
    <Data Name="NewThreadId">10248</Data>
    <Data Name="StartAddress">0x00007FF8A2C50000</Data>
    <Data Name="StartModule">C:\Windows\System32\ntdll.dll</Data>
    <Data Name="StartFunction">RtlUserThreadStart</Data>
    <Data Name="SourceUser">FBI\admin.local</Data>
    <Data Name="TargetUser">NT AUTHORITY\SYSTEM</Data>
  </EventData>
</Event>

<!-- EVENT 4: Windows Security Event ID 4673 - Sensitive Privilege Use (SeDebugPrivilege) -->
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-A5BA-3E3B0328C30D}" />
    <EventID>4673</EventID>
    <Version>1</Version>
    <Level>0</Level>
    <Task>13056</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8020000000000000</Keywords>
    <TimeCreated SystemTime="2025-12-01T11:30:15.890Z" />
    <EventRecordID>2345671</EventRecordID>
    <Correlation />
    <Execution ProcessID="676" ThreadID="9124" />
    <Channel>Security</Channel>
    <Computer>FBI-FIELD-OFFICE-23.fbi.gov</Computer>
    <Security />
  </System>
  <EventData>
    <Data Name="SubjectUserSid">S-1-5-21-1234567890-9876543210-1111222233-500</Data>
    <Data Name="SubjectUserName">admin.local</Data>
    <Data Name="SubjectDomainName">FBI</Data>
    <Data Name="SubjectLogonId">0x4A3B2C</Data>
    <Data Name="ObjectServer">NT Local Security Authority / Authentication Service</Data>
    <Data Name="Service">LsaRegisterLogonProcess()</Data>
    <Data Name="PrivilegeList">SeDebugPrivilege</Data>
    <Data Name="ProcessId">0x2234</Data>
    <Data Name="ProcessName">C:\Users\Public\Downloads\mim.exe</Data>
  </EventData>
</Event>

<!-- EVENT 5: Sysmon Event ID 11 - Credential File Output Creation -->
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Microsoft-Windows-Sysmon" Guid="{5770385F-C22A-43E0-BF4C-06F5698FFBD9}" />
    <EventID>11</EventID>
    <Version>2</Version>
    <Level>4</Level>
    <Task>11</Task>
    <Opcode>0</Opcode>
    <Keywords>0x8000000000000000</Keywords>
    <TimeCreated SystemTime="2025-12-01T11:30:18.123Z" />
    <EventRecordID>645126</EventRecordID>
    <Correlation />
    <Execution ProcessID="2856" ThreadID="3912" />
    <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
    <Computer>FBI-FIELD-OFFICE-23.fbi.gov</Computer>
    <Security UserID="S-1-5-18" />
  </System>
  <EventData>
    <Data Name="RuleName">technique_id=T1005,technique_name=Data from Local System</Data>
    <Data Name="UtcTime">2025-12-01 11:30:18.123</Data>
    <Data Name="ProcessGuid">{F6A7B8C9-0123-4DEF-5678-901234567890}</Data>
    <Data Name="ProcessId">8756</Data>
    <Data Name="Image">C:\Users\Public\Downloads\mim.exe</Data>
    <Data Name="TargetFilename">C:\Users\Public\Downloads\credentials.txt</Data>
    <Data Name="CreationUtcTime">2025-12-01 11:30:18.123</Data>
    <Data Name="User">FBI\admin.local</Data>
  </EventData>
</Event>
